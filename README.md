# RPA-3095 V2 - –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ CF16

Python-–≤–µ—Ä—Å–∏—è VBA –º–∞–∫—Ä–æ—Å–æ–≤ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞—Å—á—ë—Ç–æ–≤ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ CF16.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ë–ª–æ–∫ 1**: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ª–∏—Å—Ç–æ–≤ —Å –†–∞—Å—á–µ—Ç–∞–º–∏ –∏ –ú—ç–ø–∏–Ω–≥–∏
- **–ë–ª–æ–∫ 2**: –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á—ë—Ç–∞ –ø–æ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–µ CF16
- –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ PySide6
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Windows –∏ Linux
- –†–∞–±–æ—Ç–∞ —Å Excel –±–µ–∑ COM-–æ–±—ä–µ–∫—Ç–æ–≤ (–∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å)
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ç–∞–π–º–∏–Ω–≥ –æ–ø–µ—Ä–∞—Ü–∏–π

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.9.18 –∏–ª–∏ –≤—ã—à–µ
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ `requirements.txt`

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### Windows

```powershell
# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python -m venv venv

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è
.\venv\Scripts\activate

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt
```

### Linux

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python3 -m venv venv

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è
source venv/bin/activate

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt
```

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫

### GUI —Ä–µ–∂–∏–º (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
python modules/main.py
```

### CLI —Ä–µ–∂–∏–º

```bash
# –ë–ª–æ–∫ 1: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ª–∏—Å—Ç–æ–≤
python modules/main.py --cli 1 \
    --macros "path/to/macros.xlsm" \
    --marja "path/to/marja.xlsx" \
    --vgo "path/to/vgo.xlsb"

# –ë–ª–æ–∫ 2: –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏
python modules/main.py --cli 2 --macros "path/to/macros.xlsm"
```

### –°–ø—Ä–∞–≤–∫–∞

```bash
python modules/main.py --help
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
RPA-3095-V2/
‚îú‚îÄ‚îÄ requirements.txt        # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îú‚îÄ‚îÄ README.md              # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ
‚îú‚îÄ‚îÄ modules/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py            # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –∑–∞–ø—É—Å–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ logger.py          # –ú–æ–¥—É–ª—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ç–∞–π–º–∏–Ω–≥–∞
‚îÇ   ‚îú‚îÄ‚îÄ excel_handler.py   # –ú–æ–¥—É–ª—å —Ä–∞–±–æ—Ç—ã —Å Excel
‚îÇ   ‚îú‚îÄ‚îÄ helpers.py         # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ create_preview_data.py  # –õ–æ–≥–∏–∫–∞ –±–ª–æ–∫–∞ 1
‚îÇ   ‚îú‚îÄ‚îÄ unload_corr.py     # –õ–æ–≥–∏–∫–∞ –±–ª–æ–∫–∞ 2
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ gui/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îî‚îÄ‚îÄ main_window.py # –ì–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ
‚îú‚îÄ‚îÄ data/                  # –î–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ
‚îî‚îÄ‚îÄ logs/                  # –õ–æ–≥–∏ (—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
```

## üìä –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã Excel

- `.xlsx` - Excel 2007+ (—á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å)
- `.xlsm` - Excel —Å –º–∞–∫—Ä–æ—Å–∞–º–∏ (—á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å)
- `.xls` - Excel 97-2003 (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ)
- `.xlsb` - Excel Binary (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ)

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –§–∞–π–ª—ã .xlsb –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ .xlsx

## üîÑ –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

### –ë–ª–æ–∫ 1: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ª–∏—Å—Ç–æ–≤

1. –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π —Å –ª–∏—Å—Ç–∞ "–ò—Å–∫–ª—é—á–µ–Ω–∏–µ_—Å—Ç–∞—Ç–µ–π"
2. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –≤–Ω–µ—à–Ω–µ–≥–æ —Ñ–∞–π–ª–∞ –ú–∞—Ä–∂–∞ (–ª–∏—Å—Ç "3_–ø37_–ú–∞—Ä–∂–∞")
3. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–∞–π–ª–∞ –í–ì–û
4. –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–æ—Ä–º—É–ª –Ω–∞ –ª–∏—Å—Ç–µ "–ú–ê–†–ñ–ê"
5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ –¢2
6. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –¶–§–û
7. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—á—ë—Ç–Ω—ã—Ö –ª–∏—Å—Ç–æ–≤ (8 –ª–∏—Å—Ç–æ–≤)
8. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º—ç–ø–ø–∏–Ω–≥–∞

### –ë–ª–æ–∫ 2: –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏

1. –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞ "–ö–û–†–†–ï–ö–¢–ò–†–û–í–ö–ê_–®–ê–ë–õ–û–ù"
2. –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Å–æ –≤—Å–µ—Ö —Ä–∞—Å—á—ë—Ç–Ω—ã—Ö –ª–∏—Å—Ç–æ–≤
3. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–±—â–∏—Ö —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤ (–°—á—ë—Ç, –û–ø–∏—Å–∞–Ω–∏–µ)
4. –£–¥–∞–ª–µ–Ω–∏–µ –Ω—É–ª–µ–≤—ã—Ö –∏ –ø—É—Å—Ç—ã—Ö –∑–∞–ø–∏—Å–µ–π
5. –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Ñ–æ—Ä–º—É–ª—ã
6. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–ø–∫—É `logs/` –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
```
cf16_YYYYMMDD_HHMMSS.log
```

–£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:
- `DEBUG` - –ø–æ–¥—Ä–æ–±–Ω–∞—è –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- `INFO` - –æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ö–æ–¥–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- `WARNING` - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- `ERROR` - –æ—à–∏–±–∫–∏

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –û—à–∏–±–∫–∞ "–ù–µ –Ω–∞–π–¥–µ–Ω –ª–∏—Å—Ç ..."

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã Excel —Å–æ–¥–µ—Ä–∂–∞—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ª–∏—Å—Ç—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏.

### –û—à–∏–±–∫–∞ "–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω"

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –ø—É—Ç–µ–π –∫ —Ñ–∞–π–ª–∞–º. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –ø—É—Ç–∏ –¥–ª—è –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏.

### –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ PySide6

```bash
pip install --upgrade PySide6
```

### –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è .xlsb —Ñ–∞–π–ª–æ–≤

```bash
pip install pyxlsb
```

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ø—Ä–æ–µ–∫—Ç –†–æ—Å—Ç–µ–ª–µ–∫–æ–º.

## üë• –ê–≤—Ç–æ—Ä—ã

RPA Team

